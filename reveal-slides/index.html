<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Atelier Sage Intacct – Web Services</title>
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@5.2.1/dist/reveal.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@5.2.1/dist/theme/black.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <link rel="stylesheet" href="theme/atelier.css">
</head>
<body>
  <div class="reveal">
    <div class="slides">

      <!-- Title -->
      <section class="title-slide">
        <div class="sage-logo">
          <svg width="100" height="56" viewBox="0 0 250 141" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M27.6269 0C43.2682 0 55.9863 10.8171 56.2793 25.8724C56.4258 30.1107 53.3561 32.4512 49.9935 32.4512C46.7773 32.4512 44.0006 30.1139 43.8542 26.1654C43.7077 17.6855 36.5462 11.3997 27.4805 11.3997C19.0006 11.3997 12.5716 17.3926 12.5716 25.5794C12.5716 34.4954 18.5645 38.444 30.9896 42.9753C44.2904 47.7995 56.4258 53.4993 56.4258 70.4557C56.4258 85.2213 44.8763 97.0605 28.7988 97.0605C13.0111 97.0605 0 85.9505 0 70.8952C0 61.5397 4.53125 54.9609 8.91602 54.9609C12.7181 54.9609 15.0553 57.4447 15.0553 60.8073C15.0553 63.7305 12.5716 65.0456 12.5716 70.3092C12.5716 79.6647 20.1725 85.6576 28.7988 85.6576C37.8613 85.6576 43.8542 79.3717 43.8542 71.7708C43.8542 62.4154 37.8613 58.4701 25.4362 54.082C11.5495 49.1178 0 43.1217 0 26.6048C0 11.696 11.9857 0 27.6269 0Z" fill="#00D639"/>
            <path d="M91.4225 97.0636C75.6348 97.0636 62.4805 84.3455 62.4805 68.2648C62.4805 51.6014 75.7813 39.1763 91.862 39.1763C109.111 39.1763 121.243 52.0409 121.243 69.5832V90.9243C121.243 94.5799 118.32 97.0636 114.958 97.0636C111.449 97.0636 108.525 94.5799 108.525 90.9243V70.0194C108.525 58.4699 101.947 50.576 91.569 50.576C82.36 50.576 75.0521 58.3234 75.0521 68.2648C75.0521 77.4738 82.2135 85.3677 91.2793 85.3677C94.6419 85.3677 96.1035 84.492 98.151 84.492C100.928 84.492 103.851 86.8293 103.851 90.1919C103.848 94.7231 98.4375 97.0636 91.4225 97.0636Z" fill="#00D639"/>
            <path d="M157.262 140.625C140.889 140.625 127.295 128.929 127.295 113.727C127.295 108.61 130.218 106.273 133.581 106.273C136.943 106.273 139.72 108.467 139.867 112.705C140.013 122.207 147.614 129.222 157.116 129.222C167.204 129.222 173.779 122.79 173.779 114.456C173.779 104.954 166.471 101.009 154.046 97.0604C139.574 92.3826 127.295 85.9504 127.295 68.1183C127.295 51.7446 139.867 39.1763 156.237 39.1763C172.754 39.1763 186.351 51.1619 186.351 66.9497C186.351 76.5981 182.406 84.0526 176.995 84.0526C173.34 84.0526 170.856 81.4224 170.856 78.2062C170.856 74.8436 173.779 73.382 173.779 67.3892C173.779 57.3013 165.885 50.5793 156.383 50.5793C147.174 50.5793 139.867 57.5975 139.867 66.8065C139.867 77.1841 147.321 81.5721 159.6 85.6639C173.779 90.3416 186.351 96.188 186.351 113.291C186.351 128.639 174.219 140.625 157.262 140.625Z" fill="#00D639"/>
            <path d="M222.227 97.0638C205.853 97.0638 192.406 84.1992 192.406 68.1218C192.406 52.041 205.417 39.1797 221.494 39.1797C237.722 39.1797 250 50.4362 250 64.7624C250 70.3158 246.055 73.6784 239.623 73.6784H222.813C219.45 73.6784 216.966 71.3411 216.966 68.2682C216.966 65.345 219.45 63.0046 222.813 63.0046H235.384C236.553 63.0046 237.432 62.4186 237.432 61.25C237.432 57.0117 232.022 50.4329 221.937 50.4329C212.582 50.4329 204.981 58.4733 204.981 68.1218C204.981 77.9167 212.728 85.6641 222.376 85.6641C233.487 85.6641 237.142 79.0853 241.673 79.0853C245.475 79.0853 247.52 81.569 247.52 84.349C247.52 86.9792 245.765 89.3197 241.38 92.0964C236.989 94.8698 230.414 97.0638 222.227 97.0638Z" fill="#00D639"/>
          </svg>
        </div>
        <h1>Atelier Sage Intacct</h1>
        <p class="subtitle">Web Services</p>
        <p>Mohammed MEZOUGH</p>
        <p><small>12/02/2025</small></p>
      </section>

      <!-- Sommaire -->
      <section class="sommaire">
        <h2>Sommaire</h2>
        <div class="grid-menu">
          <a href="#/2">1. Configuration</a>
          <a href="#/3">2. Authentification</a>
          <a href="#/4">3. Lecture (Query, Export)</a>
          <a href="#/5">4. CRUD</a>
          <a href="#/6">5. Bulk</a>
        </div>
      </section>

      <!-- 1. Configuration -->
      <section>
        <section class="section-title">
          <h2>1. Authentification &amp; Accès</h2>
        </section>
        <section>
          <h3>Setup : Enregistrement App 1/2</h3>
          <ul>
            <li>Naviguer sur <strong>https://developer.sage.com/intacct</strong> – Cliquer sur View Console</li>
            <li>Connexion ou création d’un Sage ID</li>
            <li>Créer une organisation</li>
            <li>S'inscrire au programme Sage Intacct REST API (nécessite un Sender ID)</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Setup : Enregistrement App 2/2</h3>
          <ul>
            <li>Créer une application Sage Intacct</li>
            <li>Renseigner les URLs de redirection (Redirect URIs)</li>
            <li>Mot de passe Sender ID (Intacct Web Services License Password) et scope client</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Setup : Activer l’abonnement Services Web</h3>
          <ol>
            <li>Menu Société – Admin – Abonnements</li>
            <li>Activer l’abonnement Services Web</li>
          </ol>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Setup : Autorisation du Sender ID</h3>
          <ol>
            <li>Menu Société – Configuration – Société – onglet Sécurité – Autorisation des services web</li>
            <li>Cliquer sur Ajouter et renseigner le Sender ID et une description si nécessaire</li>
          </ol>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Setup : Création du compte service Web</h3>
          <ol>
            <li>Menu Société – Admin – Utilisateurs des services web</li>
            <li>Cliquer sur Ajouter et renseigner l’ID utilisateur, Adresse e-mail du compte et un Nom du contact</li>
          </ol>
          <ul>
            <li>Pour des raisons de sécurité, l'utilisateur de type services web ne pourra pas accéder à l'interface Sage Intacct ; l'accès se fait uniquement via les services web.</li>
            <li>Il est possible d'utiliser un utilisateur normal pour les appels API mais c’est déconseillé en production.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Setup : Autorisation de l’ID Client</h3>
          <ol>
            <li>Menu Société – Configuration – Société – onglet Sécurité – Applications clients autorisées</li>
            <li>Cliquer sur Ajouter et renseigner l’ID Client et l’ID de l’utilisateur webservice <strong>créé</strong> précédemment.</li>
          </ol>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Configuration : appsettings.json (C#)</h3>
          <pre><code class="language-json">{
  "IdClient": "xxx.app.sage.com",
  "SecretClient": "votre-secret-client",
  "Utilisateur": "webservice@votre-societe"
}</code></pre>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
      </section>

      <!-- 2. Authentication -->
      <section>
        <section class="section-title">
          <h2>2. Authentification</h2>
        </section>
        <section data-auto-animate>
          <h3 data-id="auth-title">OAuth 2.0 : Flux Client Credentials (Machine à machine)</h3>
          <ul>
            <li>Le flux Client Credentials est utilisé pour un accès direct à l'API sans intervention de l'utilisateur.</li>
            <li>L’ID Client doit être autorisé et lié à un utilisateur Web Services dans la configuration de société.</li>
            <li>POST vers le point de terminaison token avec <code>grant_type</code>, <code>client_id</code>, <code>client_secret</code>, <code>username</code> (ou <code>session_id</code>).</li>
            <li>Format username : <code>UTILISATEUR_WEB_SERVICES@ID_SOCIÉTÉ|ENTITÉ</code> pour cibler une entité, ou sans entité pour accès global (Top Level).</li>
          </ul>
          <p><strong>Réponse :</strong> token_type (Bearer), access_token, refresh_token, expires_in (6h).</p>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>OAuth 2.0 : Flux Client Credentials – Exemple C#</h3>
          <p class="code-label">Program.cs (cas d’usage)</p>
          <div class="code-block"><pre><code class="language-csharp">var config = new ConfigurationBuilder().AddJsonFile("appsettings.json").Build();
var intacctService = new IntacctService(urlBase, config["IdClient"]!, config["SecretClient"]!, config["Utilisateur"]!);
var reponseAuth = await intacctService.ObtenirToken();
var token = new Token(reponseAuth);</code></pre></div>
          <p class="code-label">IntacctService.ObtenirToken</p>
          <div class="code-block"><pre><code class="language-csharp">var restRequest = new RestRequest("oauth2/token", Method.Post);
restRequest.AddParameter("grant_type", "client_credentials");
restRequest.AddParameter("client_id", _idClient);
restRequest.AddParameter("client_secret", _secretClient);
restRequest.AddParameter("username", _utilisateur);
return await _client.ExecuteAsync(restRequest);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>OAuth 2.0 : Flux Authorization Code</h3>
          <p>Le flux Authorization Code introduit l’identité utilisateur : l’application obtient le droit d’agir au nom d’une personne après son consentement.</p>
          <p><strong>Étape 1 (Frontend) :</strong> Redirection vers Sage ; l’utilisateur est renvoyé vers votre <code>/callback?code=...</code>.</p>
          <p><strong>Étape 2 (Backend) :</strong> L’application extrait le paramètre <code>code</code> et l’envoie à l’endpoint token (grant_type=authorization_code).</p>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Authorization Code – Exemple Worker (JS)</h3>
          <pre><code class="language-javascript" data-line-numbers="1-25">// Redirection (étape 1)
const params = new URLSearchParams({
  response_type: "code",
  client_id: config.idClient,
  redirect_uri: config.redirectUri,
  state: "atelier_2026",
  scope: "offline_access",
});
const authUrl = `${config.authEndpoint}?${params.toString()}`;
// → renvoyer l'utilisateur vers authUrl</code></pre>
          <pre><code class="language-javascript" data-line-numbers="52-72">// Callback : échange code → token (étape 2)
const code = url.searchParams.get("code");
const tokenResponse = await fetch(config.tokenEndpoint, {
  method: "POST",
  headers: { "Content-Type": "application/x-www-form-urlencoded" },
  body: new URLSearchParams({
    grant_type: "authorization_code",
    code,
    redirect_uri: config.redirectUri,
    client_id: config.idClient,
    client_secret: config.secretClient,
  }),
});
const tokenData = await tokenResponse.json();
const token = tokenData.access_token;</code></pre>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
      </section>

      <!-- 3. Reading (Query, Export) -->
      <section>
        <section class="section-title">
          <h2>3. Consultation (Query Service)</h2>
        </section>
        <section>
          <h3>Service de Modèle (Model Service)</h3>
          <p>Obtenir les détails d’une ressource (champs, types, valeurs autorisées, relations).</p>
          <ul>
            <li>Résumé global : <code>/services/core/model</code></li>
            <li>Ressource spécifique : <code>/services/core/model?name=company-config/department</code></li>
            <li>Version : <code>?name=...&amp;version=v1</code></li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section data-auto-animate>
          <h3 data-id="query-struct">Le Service Query : Structure 1/3</h3>
          <p>Endpoint : <code>/services/core/query</code></p>
          <ul>
            <li><strong>object</strong> : Type d’objet (ex. accounts-payable/vendor). Objets personnalisés : platform-apps/nsp::&lt;name&gt;</li>
            <li><strong>fields</strong> : Liste des champs (simples : id, name ; liés : vendor.id). Agrégats : sum:amount, count:id, min, max, avg.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section data-auto-animate>
          <h3 data-id="query-struct">Le Service Query : Structure 2/3</h3>
          <p>Filtrage (filters, filterExpression, filterParameters)</p>
          <ul>
            <li>Opérateurs : $eq, $ne, $lt, $gt, $in, $between, $startsWith, $contains.</li>
            <li>filterExpression : combiner les filtres (ex. (1 and 2) or 3).</li>
            <li>Sensibilité à la casse : caseSensitiveComparison (true par défaut).</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section data-auto-animate>
          <h3 data-id="query-struct">Le Service Query : Structure 3/3</h3>
          <p>Résultat et pagination</p>
          <ul>
            <li><strong>orderBy</strong> : champs + direction (asc / desc).</li>
            <li><strong>start</strong> : premier enregistrement ; <strong>size</strong> : nombre max (4000).</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Query : Exemple C#</h3>
          <p class="code-label">Modèle (QueryRequest)</p>
          <div class="code-block"><pre><code class="language-csharp">var queryRequest = new QueryRequest {
  Object = "accounts-payable/bill",
  Fields = new List&lt;string&gt; { "id", "billNumber", "vendor.id", "postingDate", "totalTxnAmount" },
  Filters = ..., FilterExpression = ..., OrderBy = ..., Start = 1, Size = 100
};</code></pre></div>
          <p class="code-label">IntacctService.Query</p>
          <div class="code-block"><pre><code class="language-csharp">var restRequest = new RestRequest("services/core/query", Method.Post);
restRequest.AddHeader("Authorization", "Bearer " + accessToken);
restRequest.AddJsonBody(request);
return await _client.ExecuteAsync(restRequest);</code></pre></div>
          <p class="code-label">Program.cs (RunQueryAndExportAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var reponseQuery = await intacctService.Query(queryRequest, token.AccessToken);
var queryResponse = JsonConvert.DeserializeObject&lt;QueryResponse&gt;(reponseQuery.Content!);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Le Service Export</h3>
          <p>Même logique que Query, avec :</p>
          <ul>
            <li>Endpoint : <code>/services/core/export</code></li>
            <li>Structure : champ <code>fileType</code> à la racine + requête dans l’objet <code>query</code>.</li>
            <li>Formats : csv, xlsx, xml, pdf, word.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Export : Exemple C#</h3>
          <p class="code-label">IntacctService.Export</p>
          <div class="code-block"><pre><code class="language-csharp">var restRequest = new RestRequest("services/core/export", Method.Post);
restRequest.AddHeader("Authorization", "Bearer " + accessToken);
restRequest.AddJsonBody(new { Query = request, FileType = fileType });</code></pre></div>
          <p class="code-label">Program.cs (RunQueryAndExportAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var fileType = ExportFileType.Pdf;
var reponseExport = await intacctService.Export(queryRequest, fileType, token.AccessToken);
File.WriteAllBytes(Path.Combine("C:\\temp", nomFichier), reponseExport.RawBytes!);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
      </section>

      <!-- 4. CRUD -->
      <section>
        <section class="section-title">
          <h2>4. Opérations de Données (CRUD)</h2>
        </section>
        <section>
          <h3>Lecture (GET)</h3>
          <p>Consulter les ressources : collection ou enregistrement spécifique.</p>
          <ul>
            <li>Format : <code>/objects/{application}/{object}</code> (ex. accounts-receivable/invoice).</li>
            <li>List : liste simplifiée (clés, IDs, liens). Get Single : <code>/{object}/{key}</code> pour le détail complet.</li>
            <li>ia::meta : totalCount, next, previous. Limite : List ne supporte pas pagination ni filtrage → utiliser le Query Service.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>GET : Exemple C#</h3>
          <p class="code-label">Modèles (InvoiceReferenceListResponse, InvoiceDetailResponse)</p>
          <div class="code-block"><pre><code class="language-csharp">// Liste : Result = liste de { Key, Id, Href }
// Détail : Invoice = en-tête + lignes (Customer, Lines, ...)</code></pre></div>
          <p class="code-label">IntacctService.GetInvoices / GetInvoiceByKey</p>
          <div class="code-block"><pre><code class="language-csharp">GetInvoices: RestRequest("objects/accounts-receivable/invoice", Method.Get);
GetInvoiceByKey: RestRequest($"objects/accounts-receivable/invoice/{key}", Method.Get);</code></pre></div>
          <p class="code-label">Program.cs (RunGetInvoicesAsync / RunGetInvoiceDetailAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var reponse = await intacctService.GetInvoices(token.AccessToken);
var list = JsonConvert.DeserializeObject&lt;InvoiceReferenceListResponse&gt;(reponse.Content!);
var reponseDetail = await intacctService.GetInvoiceByKey("11", token.AccessToken);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Création (POST)</h3>
          <p>Soumettre un nouvel enregistrement vers une ressource.</p>
          <ul>
            <li>Endpoint : <code>POST /objects/{application}/{object}</code> (ex. accounts-receivable/invoice).</li>
            <li>Body JSON : champs obligatoires (dates, montants, objets liés ex. customer).</li>
            <li>Réponse 201 : ia::result avec ID, Key, HREF.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>POST : Exemple C#</h3>
          <p class="code-label">Modèle (InvoiceCreate, Line, IdRef)</p>
          <div class="code-block"><pre><code class="language-csharp">customer = { id }, invoiceDate, dueDate, lines = [ { txnAmount, glAccount, dimensions } ]</code></pre></div>
          <p class="code-label">IntacctService.CreateInvoice</p>
          <div class="code-block"><pre><code class="language-csharp">RestRequest("objects/accounts-receivable/invoice", Method.Post);
restRequest.AddJsonBody(invoiceCreate);</code></pre></div>
          <p class="code-label">Program.cs (RunInvoiceCreateAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var createRequest = new InvoiceCreate { customer = { id = "CL0170" }, invoiceDate = "2025-12-06", dueDate = "2025-12-31", lines = [...] };
var reponse = await intacctService.CreateInvoice(createRequest, token.AccessToken);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Mise à jour (PATCH)</h3>
          <p>Modification partielle : seuls les champs envoyés sont mis à jour.</p>
          <ul>
            <li>Facture : <code>PATCH /objects/accounts-receivable/invoice/{key}</code> (ex. referenceNumber, description, dueDate).</li>
            <li>Ligne facture : <code>PATCH .../invoice-line/{key}</code> ; Ligne bill : <code>PATCH .../bill-line/{key}</code>.</li>
            <li>C# : sérialisation avec NullValueHandling.Ignore pour n’envoyer que les champs renseignés.</li>
          </ul>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>PATCH : Exemple C#</h3>
          <p class="code-label">Modèles (InvoiceUpdate, BillLineUpdate, InvoiceLineUpdate)</p>
          <div class="code-block"><pre><code class="language-csharp">InvoiceUpdate: referenceNumber, description, dueDate. BillLineUpdate: TxnAmount, Memo, Dimensions. InvoiceLineUpdate: txnAmount, memo.</code></pre></div>
          <p class="code-label">IntacctService.UpdateInvoice / UpdateBillLine / UpdateInvoiceLine</p>
          <div class="code-block"><pre><code class="language-csharp">UpdateInvoice: PATCH invoice/{key}. UpdateBillLine: PATCH bill-line/{key}. UpdateInvoiceLine: PATCH invoice-line/{key}. AddStringBody avec NullValueHandling.Ignore.</code></pre></div>
          <p class="code-label">Program.cs (RunInvoiceUpdateAsync, RunBillLineUpdateAsync, RunInvoiceLineUpdateAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var updateRequest = new InvoiceUpdate { referenceNumber = "PO-UPDATED-99", description = "Modifié par Atelier" };
await intacctService.UpdateInvoice(updateRequest, "11", token.AccessToken);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Suppression (DELETE)</h3>
          <p>Retrait définitif d’une ressource identifiée par sa clé.</p>
          <ul>
            <li>Endpoint : <code>DELETE /objects/accounts-receivable/invoice/{key}</code></li>
            <li>Pas de corps. Réponse : 200 OK (ou 204).</li>
          </ul>
          <p class="code-label">IntacctService.DeleteInvoice</p>
          <div class="code-block"><pre><code class="language-csharp">RestRequest($"objects/accounts-receivable/invoice/{key}", Method.Delete);</code></pre></div>
          <p class="code-label">Program.cs (RunInvoiceDelete)</p>
          <div class="code-block"><pre><code class="language-csharp">var reponse = await intacctService.DeleteInvoice("11", token.AccessToken);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
      </section>

      <!-- 5. Bulk -->
      <section>
        <section class="section-title">
          <h2>5. Performance &amp; Bulk</h2>
        </section>
        <section>
          <h3>Requêtes en masse (Bulk)</h3>
          <p>Envoyer plusieurs opérations (create, update, delete) sur un même type d’objet dans un fichier JSON, traité de façon asynchrone.</p>
          <p><strong>Format</strong></p>
          <ul>
            <li>Create : <code>POST /services/bulk/job/create</code> (multipart : ia::requestBody + fichier JSON). Réponse : jobId.</li>
            <li>Statut : <code>GET /services/bulk/job/status?jobId=...&amp;download=true</code> (optionnel).</li>
          </ul>
          <p><strong>Core</strong> : objectName, operation, jobFile, fileContentType (json), callbackURL (optionnel). Statuts : queued → preprocessing → processing → completed / failed.</p>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
        <section>
          <h3>Bulk : Exemple C#</h3>
          <p class="code-label">IntacctService.BulkCreate / BulkStatus</p>
          <div class="code-block"><pre><code class="language-csharp">BulkCreate: POST multipart (ia::requestBody + fichier JSON). BulkStatus: GET job/status?jobId=...&amp;download=true.</code></pre></div>
          <p class="code-label">Program.cs (RunBulkAsync)</p>
          <div class="code-block"><pre><code class="language-csharp">var createRes = await intacctService.BulkCreate(objectName, operation, jobFile, jsonBody, token.AccessToken, callbackUrl);
var jobId = (string)createData["ia::result"].jobId;
do {
  await Task.Delay(2000);
  var statusRes = await intacctService.BulkStatus(jobId, token.AccessToken, download: false);
  status = (string)statusData["ia::result"].status;
} while (status != "completed" && status != "failed");
if (status == "completed")
  var downloadRes = await intacctService.BulkStatus(jobId, token.AccessToken, download: true);</code></pre></div>
          <p class="slide-footer">© 2024 The Sage Group plc, or its licensors. All rights reserved.</p>
        </section>
      </section>

    </div>
  </div>

  <script src="https://unpkg.com/reveal.js@5.2.1/dist/reveal.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/csharp.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
  <script>
    Reveal.initialize({
      hash: true,
      transition: 'slide',
      transitionSpeed: 'default',
      progress: true,
      controls: true,
      center: true,
      autoAnimateDuration: 0.6,
      autoAnimateEasing: 'ease-out',
      width: 1120,
      height: 700,
      margin: 0.04,
      minScale: 0.2,
      maxScale: 2.0
    });
    Reveal.on('ready', function() {
      document.querySelectorAll('pre code').forEach(function(block) {
        hljs.highlightElement(block);
      });
    });
    Reveal.on('slidechanged', function() {
      document.querySelectorAll('pre code').forEach(function(block) {
        hljs.highlightElement(block);
      });
    });
  </script>
</body>
</html>
